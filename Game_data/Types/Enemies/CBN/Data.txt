name = Cloaking Burrow-nit

big_damage_interval = 20
drops_corpse = true
first_state = burrowed
height = 64
max_carriers = 16
max_health = 500
move_speed = 50
near_angle = 0.78
near_radius = 40
pikmin_seeds = 10
pushable = true
pushes = true
radius = 30
rotation_speed = 3
sight_radius = 200
territory_radius = 300
value = 30
weight = 8

script{
    burrowed{
        on_enter{
            animation = burrowed
        }
        on_near_opponent{
            state = unburrowing
        }
    }
    
    unburrowing{
        on_enter{
            animation = unburrow
        }
        on_animation_end{
            state = examining
        }
    }
    
    examining{
        on_enter{
            animation = look
            move = stop
        }
        on_see_opponent{
            focus = mob
            state = chasing
        }
        on_big_damage{
            state = shaking
        }
        on_death{
            state = dying
        }
        on_animation_end{
            state = returning
        }
    }
    
    examining_ignoring{
        on_enter{
            animation = look
            move = stop
        }
        on_big_damage{
            state = shaking
        }
        on_death{
            state = dying
        }
        on_animation_end{
            state = returning_ignoring
        }
    }
    
    chasing{
        on_enter{
            animation = walk
            move = focused_mob
        }
        on_face_opponent{
            state = attacking
        }
        on_lose_focused_mob{
            state = examining_ignoring
        }
        on_far_from_home{
            state = examining_ignoring
        }
        on_big_damage{
            state = shaking
        }
        on_death{
            state = dying
        }
    }
    
    attacking{
        on_enter{
            move = stop
            animation = attack
            chomp = 1 mouth
        }
        on_animation_end{
            state = checking_mouth
        }
    }
    
    checking_mouth{
        on_mouth_occupied{
            state = eating
        }
        on_mouth_empty{
            state = examining
        }
        on_death{
            state = dying
        }
    }
    
    eating{
        on_enter{
            chomp =
            animation = swallow
        }
        on_animation_end{
            eat = all
            state = examining
        }
        on_death{
            state = dying
        }
    }
    
    shaking{
        on_enter{
            move = stop
            animation = shake
        }
        on_animation_end{
            state = examining
        }
        on_death{
            state = dying
        }
    }
    
    returning{
        on_enter{
            move = home
            animation = walk
        }
        on_reach_destination{
            state = burrowing
        }
        on_see_opponent{
            state = chasing
        }
        on_death{
            state = dying
        }
    }
    
    returning_ignoring{
        on_enter{
            move = home
            animation = walk
        }
        on_reach_destination{
            state = burrowing
        }
        on_death{
            state = dying
        }
    }
    
    burrowing{
        on_enter{
            animation = burrow
        }
        on_animation_end{
            state = burrowed
        }
    }
    
    dying{
        on_enter{
            special_function = die_start
            animation = die
            move = stop
            eat = 
        }
        on_animation_end{
            special_function = die_end
            state = dead
        }
    }
    
    dead{
        
    }
}
    
    
    
    



    //on_spawn{
    //    animation = burrowed
    //    var = burrowed true
    //}
    //
    //on_see_prey{
    //    if = burrowed true
    //    animation = unburrow
    //    if = burrowed true
    //    wait = animation
    //    
    //    animation = walk
    //    move = prey
    //    var = burrowed false
    //}
    //
    //on_near_prey{
    //    move = stop
    //    animation = attack
    //    chomp = mouth
    //    wait = animation
    //    chomp = 
    //}
    //
    //on_big_damage{
    //    animation = shake
    //    wait = animation
    //}
    //
    //on_attack_hit{
    //    animation = swallow
    //    wait = animation
    //    eat = all
    //}
    //
    //on_lose_prey{
    //    animation = idle
    //    move = stop
    //    wait = 0.5
    //    animation = walk
    //    move = home
    //}
    //
    //on_reach_home{
    //    animation = idle
    //    wait = 0.3
    //    animation = burrow
    //    wait = animation
    //    animation = burrowed
    //    var = burrowed true
    //}
    //
    //on_death{
    //    special_function = die_start
    //    animation = die
    //    wait = animation
    //    special_function = die_end
    //}